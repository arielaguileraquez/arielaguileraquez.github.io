<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Aki Sushi | Pedidos</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { 
  font-family: Arial, sans-serif; 
  background: #f9f9f9; 
  color: #111; 
  padding: 20px; 
}
h1,h2 { color: #111; }

.btn-primary { 
  background:#111; 
  color:#fff; 
  border:none; 
}
.btn-primary:hover { background:#333; }

.cart-panel {
  width: 320px;
  max-height: 90vh;
  overflow-y:auto;
  position: fixed;
  top: 56px;
  right: 10px;
  background: #fff;
  border:1px solid #ccc;
  border-radius:10px;
  padding:15px;
  z-index:1055;
  display:none;
  box-shadow:0 2px 10px rgba(0,0,0,0.15);
}

.cart-item { 
  border-bottom:1px solid #eee; 
  padding:6px 0; 
}

#total { font-weight:bold; font-size:1.2rem; color:#111; }
#precioModal { font-weight:bold; font-size:1.2rem; margin-top:10px; color:#111; }

.pedido-rapido button { margin:5px; font-size:1rem; }

#cantidad { width:60px; }

@media (max-width: 576px) {
  #pedidoModal .modal-dialog,
  .pedido-modal .modal-dialog {
    max-width: 100%; margin: 0; height: 100%;
  }
  #pedidoModal .modal-content,
  .pedido-modal .modal-content {
    height: 100%; border-radius: 0; font-size: 1.2rem; display: flex; flex-direction: column;
  }
  #pedidoModal .modal-body,
  .pedido-modal .modal-body { flex: 1; overflow-y: auto; }
  #pedidoModal label,
  .pedido-modal label { font-size:1.2rem; margin-bottom:0.5rem; }
  #pedidoModal input[type="checkbox"],
  .pedido-modal input[type="checkbox"] { transform: scale(1.7); margin-right: 10px; }
  #pedidoModal input[type="number"],
  #pedidoModal select,
  #pedidoModal button,
  .pedido-modal input[type="number"],
  .pedido-modal select,
  .pedido-modal button { font-size:1.2rem; padding:0.75rem 1rem; }
  .pedido-rapido button { font-size:1.2rem; padding:0.5rem 1rem; margin-bottom:0.5rem; }
  .btn-lg { font-size:1.5rem; padding:15px 25px; }
  .cart-panel { width:90%; right:5%; top:70px; max-height:80vh; padding:1rem; }
}
</style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg bg-white shadow-sm mb-3">
  <div class="container-fluid d-flex justify-content-between align-items-center">
    <img src="logo.jpg" alt="Logo" style="height:60px;">
    <span class="navbar-brand fw-bold text-dark">Aki Foods</span>
    <button id="cartBtn" class="btn btn-outline-dark position-relative">
      üõí
      <span id="cartCount" class="badge bg-dark position-absolute top-0 start-100 translate-middle rounded-pill">0</span>
    </button>
  </div>
</nav>

<!-- Carrito -->
<div id="cartPanel" class="cart-panel shadow-sm">
  <h5 class="text-center">üõí Tu pedido</h5>
  <div id="carrito"></div>
  <p id="total">Total: $0</p>
  <div class="mt-2">
    <label><input type="radio" name="entrega" value="retiro" checked> Retiro en local</label><br>
    <label><input type="radio" name="entrega" value="reparto"> Reparto (+$1000)</label>
    <input id="direccion" class="form-control mt-2" placeholder="Direcci√≥n (si reparto)" style="display:none;">
  </div>
  <button class="btn btn-primary w-100 mt-3" onclick="pagar()">Pagar</button>
</div>

<!-- Botones de productos -->
<div class="d-flex flex-wrap justify-content-center gap-3 mt-4">
  <button class="btn btn-primary btn-lg d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#handrollModal" style="gap:10px;">
    <img src="handrolls.jpg" alt="Handroll" style="height:60px;"> Handroll
  </button>
  <button class="btn btn-primary btn-lg d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#mixtasModal" style="gap:10px;">
    <img src="handrolls.jpg" alt="Promos" style="height:60px;"> Promos Mixtas
  </button>
  <button class="btn btn-primary btn-lg d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#fritasModal" style="gap:10px;">
    <img src="handrolls.jpg" alt="Fritas" style="height:60px;"> Promos Fritas
  </button>
  <button class="btn btn-primary btn-lg d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#gohanModal" style="gap:10px;">
    <img src="gohan.jpg" alt="Gohan" style="height:60px;"> Gohan
  </button>
  <button class="btn btn-primary btn-lg d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#acevichadoModal" style="gap:10px;">
    <img src="handrolls.jpg" alt="Acevichado" style="height:60px;"> Sushi Acevichado
  </button>
  <button class="btn btn-primary btn-lg d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#acevichadoModal" style="gap:10px;">
    <img src="handrolls.jpg" alt="Acevichado" style="height:60px;"> Promos Especiales
  </button>
  <button class="btn btn-primary btn-lg d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#acevichadoModal" style="gap:10px;">
    <img src="handrolls.jpg" alt="Acevichado" style="height:60px;"> Extras
  </button>
  <button class="btn btn-primary btn-lg d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#acevichadoModal" style="gap:10px;">
    <img src="handrolls.jpg" alt="Acevichado" style="height:60px;"> Bebestibles
  </button>
</div>

<!-- üî∏ MODAL HANDROLL (tu l√≥gica original) -->
<div class="modal fade pedido-modal" id="handrollModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
    <div class="modal-content">
      <div class="modal-header bg-dark text-white">
        <h5 class="modal-title">Arma tu Handroll</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="pedido-rapido mb-3">
          <h6 class="fw-bold">Pedidos r√°pidos üç£</h6>
          <button class="btn btn-outline-dark" onclick="pedidoRapido('bigpappa',['pollo'],['palta','queso'])">BigPappa Pollo + Palta + Queso</button>
          <button class="btn btn-outline-dark" onclick="pedidoRapido('bigpappa',['camaron'],['palta','queso_crema'])">BigPappa Camar√≥n + Palta + Queso Crema</button>
          <button class="btn btn-outline-dark" onclick="pedidoRapido('goliat',['salmon'],['palta','queso_crema','cebollin'])">Goliat Salm√≥n + Palta + Queso Crema + Ceboll√≠n</button>
        </div>

        <label class="fw-bold">Tipo</label>
        <select id="tipo" class="form-select mb-3">
          <option value="bigpappa">Big Pappa (3 ingredientes)</option>
          <option value="goliat">Goliat XL (4 ingredientes)</option>
        </select>

        <div>
          <h6>Prote√≠nas (la primera incluida, extra $800):</h6>
          <div id="proteinas" class="d-flex flex-column">
            <label><input type="checkbox" value="kanikama"> Kanikama</label>
            <label><input type="checkbox" value="pollo"> Pollo</label>
            <label><input type="checkbox" value="camaron"> Camar√≥n</label>
            <label><input type="checkbox" value="salmon"> Salm√≥n</label>
            <label><input type="checkbox" value="champinon"> Champi√±√≥n</label>
          </div>
        </div>

        <div class="mt-3">
          <h6>Ingredientes (extras: vegetales $500, queso crema $600)</h6>
          <div id="ingredientes" class="d-flex flex-column">
            <label><input type="checkbox" value="queso"> Queso</label>
            <label><input type="checkbox" value="palta"> Palta</label>
            <label><input type="checkbox" value="cebollin"> Ceboll√≠n</label>
            <label><input type="checkbox" value="morron"> Morr√≥n</label>
            <label><input type="checkbox" value="queso_crema"> Queso Crema</label>
          </div>
        </div>

        <div class="mt-3">
          <label>Cantidad</label>
          <input id="cantidad" type="number" min="1" value="1" class="form-control w-25">
        </div>

        

      </div>
      <div class="modal-footer">
        <p id="precioModal">üí∞ Total: $0</p>
        <button class="btn btn-primary" onclick="agregarAlCarrito()">Agregar al carrito</button>
      </div>
    </div>
  </div>
</div>

<!-- üî∏ MODALES ADICIONALES (usan agregarItemDirecto o pueden extenderse) -->
<div class="modal fade pedido-modal" id="mixtasModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
    <div class="modal-content">
      <div class="modal-header bg-dark text-white">
        <h5 class="modal-title">Promos Mixtas</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="pedido-rapido mb-3">
          <h6 class="fw-bold">Pedidos r√°pidos üç£</h6>
          <button class="btn btn-outline-dark" onclick="pedidoRapidoMix('mix1')">Mix 1 (20 cortes) $8.500</button>
          <button class="btn btn-outline-dark" onclick="pedidoRapidoMix('mix2')">Mix 2 (30 cortes) $12.000</button>
          <button class="btn btn-outline-dark" onclick="pedidoRapidoMix('mix3')">Mix 3 (40 cortes) $15.000</button>
          <button class="btn btn-outline-dark" onclick="pedidoRapidoMix('mix4')">Mix 4 (50 cortes) $19.000</button>
          <button class="btn btn-outline-dark" onclick="pedidoRapidoMix('mix5')">Mix 5 (60 cortes) $22.500</button>
          <button class="btn btn-outline-dark" onclick="pedidoRapidoMix('mix6')">Mix 6 (70 cortes) $26.000</button>
          <button class="btn btn-outline-dark" onclick="pedidoRapidoMix('mix7')">Mix 7 (100 cortes) $37.000</button>
        </div>

        <div>
          <h6>Prote√≠nas (la primera incluida, extra $800):</h6>
          <div id="proteinasMix" class="d-flex flex-column">
            <label><input type="checkbox" value="kanikama"> Kanikama</label>
            <label><input type="checkbox" value="pollo"> Pollo</label>
            <label><input type="checkbox" value="camaron"> Camar√≥n</label>
            <label><input type="checkbox" value="salmon"> Salm√≥n</label>
            <label><input type="checkbox" value="champinon"> Champi√±√≥n</label>
          </div>
        </div>

        <div class="mt-3">
          <h6>Ingredientes (extras: vegetales $500, queso crema $600)</h6>
          <div id="ingredientesMix" class="d-flex flex-column">
            <label><input type="checkbox" value="queso"> Queso</label>
            <label><input type="checkbox" value="palta"> Palta</label>
            <label><input type="checkbox" value="cebollin"> Ceboll√≠n</label>
            <label><input type="checkbox" value="morron"> Morr√≥n</label>
            <label><input type="checkbox" value="queso_crema"> Queso Crema</label>
          </div>
        </div>

        <div class="mt-3">
          <label>Cantidad</label>
          <input id="cantidadMix" type="number" min="1" value="1" class="form-control w-25">
        </div>
      </div>
      <div class="modal-footer">
        <p id="precioModalMix">üí∞ Total: $0</p>
        <button class="btn btn-primary" onclick="agregarAlCarritoMix()">Agregar al carrito</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade pedido-modal" id="fritasModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
    <div class="modal-content">
      <div class="modal-header bg-dark text-white"><h5 class="modal-title">Promos Fritas</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body text-center">
        <p>Selecciona tu promo Frita.</p>
        <button class="btn btn-outline-dark m-2" onclick="agregarItemDirecto('Promo Frita 15 piezas', 6500)">15 piezas - $6.500</button>
        <button class="btn btn-outline-dark m-2" onclick="agregarItemDirecto('Promo Frita 25 piezas', 12000)">25 piezas - $12.000</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade pedido-modal" id="gohanModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
    <div class="modal-content">
      <div class="modal-header bg-dark text-white"><h5 class="modal-title">Gohan</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body text-center">
        <p>Elige tu Gohan:</p>
        <button class="btn btn-outline-dark m-2" onclick="agregarItemDirecto('Gohan Pollo', 5500)">Pollo - $5.500</button>
        <button class="btn btn-outline-dark m-2" onclick="agregarItemDirecto('Gohan Camar√≥n', 6000)">Camar√≥n - $6.000</button>
        <button class="btn btn-outline-dark m-2" onclick="agregarItemDirecto('Gohan Salm√≥n', 6500)">Salm√≥n - $6.500</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade pedido-modal" id="acevichadoModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
    <div class="modal-content">
      <div class="modal-header bg-dark text-white"><h5 class="modal-title">Sushi Acevichado</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body text-center">
        <p>Elige tu Acevichado:</p>
        <button class="btn btn-outline-dark m-2" onclick="agregarItemDirecto('Acevichado Tradicional', 6500)">Tradicional - $6.500</button>
        <button class="btn btn-outline-dark m-2" onclick="agregarItemDirecto('Acevichado Salm√≥n', 7000)">Salm√≥n - $7.000</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
// -------------------- VARIABLES --------------------
const preciosBase = {
  bigpappa: { kanikama: 2500, champinon: 2800, pollo: 2800, camaron: 3000, salmon: 3500 },
  goliat: { kanikama: 3800, champinon: 4000, pollo: 4000, camaron: 4300, salmon: 4500 }
};

let carrito = [];
const $ = s => document.querySelector(s);
const $$ = s => document.querySelectorAll(s);

function formatPrice(n){
  if (isNaN(n)) return "0";
  return n.toLocaleString();
}

// -------------------- MODAL HANDROLL --------------------
function calcularPrecioModal(){
  const tipo = $('#tipo').value;
  const proteinas = Array.from($$('#proteinas input:checked')).map(e=>e.value);
  const ingredientes = Array.from($$('#ingredientes input:checked')).map(e=>e.value);
  const cant = parseInt($('#cantidad').value) || 1;
  if(proteinas.length===0) return 0;
  let precio = preciosBase[tipo][proteinas[0]]; // primera prote√≠na incluida
  if(proteinas.length>1) precio += (proteinas.length-1)*800; // extra prote√≠na
  const incluidos = tipo==='bigpappa'?2:3;
  ingredientes.forEach((ing,i)=>{
    if(i>=incluidos) precio += ing==='queso_crema'?600:500;
  });
  return precio * cant;
}

function actualizarPrecioModal(){
  $('#precioModal').textContent = `üí∞ Total: $${formatPrice(calcularPrecioModal())}`;
}

// eventos Handroll
$('#tipo').addEventListener('change', actualizarPrecioModal);
$('#cantidad').addEventListener('input', actualizarPrecioModal);
$$('#proteinas input,#ingredientes input').forEach(i=>i.addEventListener('change', actualizarPrecioModal));

function pedidoRapido(tipo, proteinas, ingredientes){
  $$('#proteinas input, #ingredientes input').forEach(e=>e.checked=false);
  $('#tipo').value = tipo;
  proteinas.forEach(p=>{ const el = $(`#proteinas input[value="${p}"]`); if(el) el.checked=true; });
  ingredientes.forEach(i=>{ const el = $(`#ingredientes input[value="${i}"]`); if(el) el.checked=true; });
  $('#cantidad').value = 1;
  actualizarPrecioModal();
}

function agregarAlCarrito(){
  const tipo = $('#tipo').value;
  const proteinas = Array.from($$('#proteinas input:checked')).map(e=>e.value);
  const ingredientes = Array.from($$('#ingredientes input:checked')).map(e=>e.value);
  const cant = parseInt($('#cantidad').value) || 1;
  if(proteinas.length===0){ alert("Debes elegir al menos una prote√≠na."); return; }
  const precio = calcularPrecioModal() / cant;
  const nombreTipo = tipo==='bigpappa' ? 'Big Pappa' : 'Goliat';
  carrito.push({ tipo: nombreTipo, proteinas, ingredientes, cant, precio });
  mostrarCarrito();
  $('#cartCount').textContent = carrito.length;
  bootstrap.Modal.getInstance($('#handrollModal')).hide();
}

// -------------------- OTROS PRODUCTOS --------------------
function agregarItemDirecto(nombre, precio){
  carrito.push({ tipo: nombre, proteinas: [], ingredientes: [], cant: 1, precio });
  mostrarCarrito();
  $('#cartCount').textContent = carrito.length;
  document.querySelectorAll('.modal.show').forEach(m=>{
    const inst = bootstrap.Modal.getInstance(m);
    if(inst) inst.hide();
  });
}

// -------------------- CARRITO --------------------
function mostrarCarrito(){
  const c = $('#carrito'); c.innerHTML = ''; let total = 0;
  carrito.forEach((i,idx)=>{
    const itemTotal = i.precio * i.cant; total += itemTotal;
    const proteinasTxt = i.proteinas.join(', ');
    const ingTxt = i.ingredientes.length>0 ? i.ingredientes.join(', ') : '';
    c.innerHTML += `
      <div class="cart-item">
        <div>
          <b>${i.cant} x ${i.tipo.toUpperCase()}</b> ${proteinasTxt?`(${proteinasTxt})`:''} - $${formatPrice(itemTotal)}
          <button class="btn btn-sm btn-outline-dark ms-2" onclick="eliminar(${idx})">‚ùå</button>
        </div>
        ${ingTxt?`<div style="font-size:0.85rem; color:#666;">+ ${ingTxt}</div>`:''}
      </div>
    `;
  });

  // costo de entrega
  const entrega = document.querySelector('input[name="entrega"]:checked')?.value;
  if(entrega==='reparto') total += 1000;
  $('#total').textContent = `Total: $${formatPrice(total)}`;

  // mostrar u ocultar input direcci√≥n
  $('#direccion').style.display = entrega==='reparto' ? 'block' : 'none';
}

function eliminar(idx){
  carrito.splice(idx,1);
  mostrarCarrito();
  $('#cartCount').textContent = carrito.length;
}

// mostrar/ocultar carrito
$('#cartBtn').addEventListener('click', ()=> {
  $('#cartPanel').style.display = $('#cartPanel').style.display==='block' ? 'none' : 'block';
});

// actualizar total al cambiar entrega
$$('input[name="entrega"]').forEach(r=>r.addEventListener('change', mostrarCarrito));

// -------------------- PAGAR --------------------
function pagar(){
  if(carrito.length===0){ alert("No hay productos en el carrito."); return; }
  let resumen = "Resumen de tu pedido:\n\n";
  carrito.forEach(i=>{
    resumen += `${i.cant} x ${i.tipo} `;
    if(i.proteinas.length) resumen += `(${i.proteinas.join(', ')}) `;
    if(i.ingredientes.length) resumen += `+ ${i.ingredientes.join(', ')} `;
    resumen += `- $${formatPrice(i.precio*i.cant)}\n`;
  });
  const entrega = document.querySelector('input[name="entrega"]:checked')?.value;
  if(entrega==='reparto') resumen += "\nCosto de reparto: $1.000";
  if(entrega==='reparto' && $('#direccion').value) resumen += `\nDirecci√≥n: ${$('#direccion').value}`;
  alert(resumen + "\n\n¬°Gracias por tu compra!");
  carrito = [];
  mostrarCarrito();
  $('#cartCount').textContent = carrito.length;
  $('#cartPanel').style.display = 'none';
}
</script>
</body>
</html>
